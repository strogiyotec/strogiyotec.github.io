<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta name="description" content="Java,List">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Do you really need a List?</title>
    <link rel="stylesheet" href="../../css/font-awesome.min.css">
    <link rel="stylesheet" href="../../css/main.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-163711919-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }

        gtag('js', new Date());

        gtag('config', 'UA-163711919-1');
    </script>
</head>
<body>
<header class="site-header">
    <div class="wrapper">
        <div class="centered">
            <img src="../../images/author.png" alt="Author" class="photo">
            <ul class="horizontal-list">
                <li>
                    <a title="Follow me on Github" href="https://github.com/strogiyotec">
                        <i class="fa fa-github fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a title="Feel free to drop me a line" href="mailto:almas337519@gmail.com">
                        <i class="fa fa-envelope fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a title="Check my stack-overflow account"
                       href="https://stackoverflow.com/users/8019439/almas-abdrazak">
                        <i class="fa fa-stack-overflow fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
                <li>
                    <a type="Follow me on medium" href="https://medium.com/@almas337519">
                        <i class="fa fa-medium fa-lg" aria-hidden="true"></i>
                    </a>
                </li>
            </ul>
        </div>
        <nav class="site-nav">
            <div class="trigger">
                <a class="page-link" href="../../index.html">About</a>
                <a class="page-link" href="../blogs.html">Blog</a>
            </div>
        </nav>
    </div>
</header>
<div class="page-content">
    <div class="wrapper">
        <div class="post">
            <header class="post-content">
                <h1 class="post-title">Java List is bloated</h1>
                <p class="post-meta">Apr 19 , 2020</p>
            </header>
            <article class="post-content">
                <p>List interface is one of the most used interface in all Java based projects.
                    However most of the time it's used only to iterate over it.
                    Here are some main methods from List interface
                </p>
                <figure class="highlight">
                        <pre><code class="language-java" data-lang="java"><span
                                class="k">int size();</span>
<span class="o">boolean add(E e);</span>
<span class="o">boolean remove(E e);</span>
<span class="o">E get(int index)</span>
</code></pre>
                </figure>
                <p>Pretty clear and understandable, other programming languages have the same contract for lists</p>
                <p>However , the main idea of this post is</p>
                <h3>Do you really need all those methods? </h3>
                <p>Let's look at an example from one of my pet project <a
                        href="https://github.com/strogiyotec/J-Riddler">J-Riddler</a></p>
                <p>Class <a
                        href="https://github.com/strogiyotec/J-Riddler/blob/master/src/main/java/com/jriddler/attrs/PrimaryKeys.java">PrimaryKeys</a>
                    implements List interface and delegate all List methods calls to the global variable <code
                            class="language-plaintext highlighter-rouge">primaryKeys</code>
                    and here is an example how this class is used in test
                </p>
                <figure class="highlight">
                        <pre><code class="language-java" data-lang="java"><span
                                class="k">final List&lt;String&gt; users = new PrimaryKeys("users", TestDbInstance.datasource);</span>
<span class="o">Assert.assertThat(users.size(), CoreMatchers.is(1));</span>
<span class="o">Assert.assertThat(users.get(0), CoreMatchers.equalTo("id"));</span>
</code></pre>
                </figure>
                <p>So what is the problem ? Well there many of them, first of all what if user will call add method and
                    add new primary key to the list or what if user delete primary key</p>
                <p>
                    In order to prevent it java has some utility methods
                    which wrap List instance into immutable List
                    <code class="language-plaintext highlighter-rouge">Collections.unmodifiableList(list);</code>.
                    Now when user tries to modify this list it throws an exception. However it still list and it should
                    follows the List contract.
                    Now users of this class should keep in mind that this list only supports fetching the data. Does
                    it  follow the <a href="https://en.wikipedia.org/wiki/Interface_segregation_principle">Interface
                    segregation principle</a>?.
                    The answer in no , it doesn't. Now users of our class depend on methods they don't use. Could we
                    improve this situation using class without modification methods ? Well partly.
                    Java doesn't provide such class. The closest interface which has this logic is Iterator , but it has
                    remove method. Anyway, comparing with list it has less methods. Let's use it instead
                </p>
                <p>
                    Few words before we start. There are a lot of java methods which accept Iterable instead, so it
                    would be better to implement Iterable interface which has a method that provides Iterator.
                </p>
                <figure class="highlight">
                        <pre><code class="language-java" data-lang="java"><span
                                class="k">public final class PrimaryKeys implements Iterable&lt;String&gt; </span>
<span class="o">    public Iterator&lt;String&gt; iterator() {</span>
<span class="o">        return this.primaryKeys.iterator();</span>
<span class="o">     }</span>
</code></pre>
                </figure>
                <p>Now it only allows you to iterate over it, but what if user want to access element by index as in the
                    test above ? Well in this case it's up to the user to convert this interface to something else such
                    as List</p>
                <figure class="highlight">
                        <pre><code class="language-java" data-lang="java"><span
                                class="k">Iterable it = new PrimaryKeys("users", TestDbInstance.datasource)</span>
<span class="o">Assert.assertThat(new ArrayList(it).get(0),CoreMatchers.is("id"))</span>
</code></pre>
                </figure>
            </article>
            <h3>The List is just a beginning</h3>
            <p>List is just an example. I face this problem everyday when I work with backend services especially Spring based services</p>
            <p>Let's say you have  <code class="language-plaintext highlighter-rouge">UserDao</code>(or Repository if you use SpringData) interface which contains 10 methods which behave as a layer between service and Database.
            you inject this Dao into  <code class="language-plaintext highlighter-rouge">UserService</code> class and you only use 3 methods out of 10</p>
            <p>Usually , as a result , this UserDao is injected into a lot of classes but none of them use all methods</p>
            <p>Not lets say you need to operate with orders inside UserService, in this case you inject <code class="language-plaintext highlighter-rouge">OrderDao</code> and use only 2 methods out of let's say 5.
            Does UserService follow single responsibility principle now ? I don't think so
            </p>
            <h3>Conclusion</h3>
            <p>List is just an example how to spoil you architecture. Try to make your interfaces as small as possible. If users of your interface use only half of methods
            then probably you should redesign your interface and split it into smaller parts</p>
        </div>
    </div>
</div>
</body>
</html>